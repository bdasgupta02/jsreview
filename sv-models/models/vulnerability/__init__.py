from joblib import load
import pandas as pd


def get_model_vuln():
    k_load = load('./models/vulnerability/vulnerability.joblib')
    return k_load


def predict_vuln(model, mccc, numpar, hor_d, hon_d, hon_t, hlen, hvoc, hdiff, params, cycl_dens):
    row = pd.DataFrame({
        'McCC': mccc,
        'NUMPAR': numpar,
        'HOR_D': hor_d,
        'HON_D': hon_d,
        'HON_T': hon_t,
        'HLEN': hlen,
        'HVOC': hvoc,
        'HDIFF': hdiff,
        'PARAMS': params,
        'CYCL_DENS': cycl_dens
    }, index=[0])
    pred = model.predict(row)
    return pred[0]
